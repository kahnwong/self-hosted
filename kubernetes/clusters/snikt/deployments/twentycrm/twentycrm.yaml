---
name: twentycrm
replicaCount: 1


statefulSets:
  containers:
    - name: postgres
      repository: twentycrm/twenty-postgres
      tag: 0.3.2
      port: 5432
      healthcheck: false
      env:
        - name: POSTGRES_PASSWORD
          value: postgrespassword
      volumeMounts:
        - name: twentycrm-db
          mountPath: /var/lib/postgresql/data
  volumes:
    - name: twentycrm-db
      hostPath:
        path: /opt/twentycrm/db
  service:
    port: 5432

deployments:
  containers:
    - name: backend
      repository: twentycrm/twenty-server
      tag: 0.3.2
      port: 3000
      healthcheck: false
      env:
        - name: SIGN_IN_PREFILLED
          value: "true"
        - name: PG_DATABASE_URL
          value: postgres://postgres:postgrespassword@twentycrm-statefulset.twentycrm.svc.cluster.local:5432/postgres
        - name: FRONT_BASE_URL
          value: https://twentycrm.karnwong.me
        - name: STORAGE_TYPE
          value: local
        - name: STORAGE_LOCAL_PATH
          value: .local-storage
      envFrom:
        - secretRef:
            name: twentycrm
    - name: frontend
      repository: twentycrm/twenty-front
      tag: 0.3.2
      port: 3001
      healthcheck: false
      env:
        - name: SIGN_IN_PREFILLED
          value: "true"
        - name: REACT_APP_SERVER_BASE_URL
          value: https://twentycrm.karnwong.me
        - name: REACT_APP_SERVER_AUTH_URL
          value: https://twentycrm.karnwong.me/auth
        - name: REACT_APP_SERVER_FILES_URL
          value: https://twentycrm.karnwong.me/files
        - name: PORT
          value: "3001"
  service:
    port: 3001
    nodePort: 30034
