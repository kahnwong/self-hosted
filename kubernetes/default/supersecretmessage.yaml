---
name: supersecretmessage
replicaCount: 1
containers:
  - name: supersecretmessage
    repository: ghcr.io/kahnwong/sup3rs3cretmes5age
    tag: 9f995dc
    port: 8082
    env:
      - name: SUPERSECRETMESSAGE_HTTP_BINDING_ADDRESS
        value: :8082
      - name: VAULT_ADDR
        value: http://localhost:8200 # all containers in the same pod share the same host
      - name: VAULT_TOKEN
        value: supersecret
    resources:
      limits:
        cpu: 999m
        memory: 512Mi
      requests:
        cpu: 20m
        memory: 64Mi
  - name: vault
    repository: vault
    tag: latest
    port: 8200
    securityContext:
      capabilities:
        add:
          - IPC_LOCK
    env:
      - name: VAULT_DEV_ROOT_TOKEN_ID
        value: supersecret
    resources:
      limits:
        cpu: 999m
        memory: 512Mi
      requests:
        cpu: 20m
        memory: 128Mi

service:
  port: 8082
  nodePort: 30000
